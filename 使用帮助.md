# GitHub 短链系统使用帮助

本文档介绍如何在 GitHub Pages 上部署并使用仓库中的静态短链跳转系统。

## 1. 准备工作

1. 拥有一个 GitHub 账号，并创建两个仓库：
   - **前端仓库**：用于存放本项目（包含 `index.html` 与 `404.html`）。
   - **数据库仓库**：仅用于存储短链数据，推荐命名为 `url-shortener-db`。
2. （可选）准备自定义域名，并在域名服务商处将其解析到 `yourusername.github.io`。

## 2. 部署前端仓库

1. 将本仓库的全部文件上传到前端仓库（或直接 Fork）。
2. 在仓库 `Settings -> Pages` 中启用 GitHub Pages，选择分支 `main`（或 `master`），目录选择 `/root`。
3. 如需自定义域名，在仓库根目录创建 `CNAME` 文件，内容为你的域名，并在 Pages 设置中填写相同域名。

## 3. 配置跳转逻辑

1. 打开 `404.html`，找到如下配置：
   ```js
   const CONFIG = {
       GITHUB_API_URL: 'https://api.github.com/repos/yourusername/url-shortener-db/issues/',
       GITHUB_TOKEN: '',
       TIMEOUT: 5000,
       CACHE_DURATION: 60
   };
   ```
2. 将 `yourusername` 和仓库名替换为你的数据库仓库信息，保持末尾的 `/issues/` 和最后的斜杠。
3. 如果数据库仓库是私有仓库，或担心 API 频率限制，建议创建一个 GitHub Personal Access Token 并填入 `GITHUB_TOKEN`。Token 至少需要 `repo` 权限，建议仅启用读取 Issues 的权限。
4. 保存修改后重新部署 GitHub Pages（通常几分钟内生效）。

## 4. 添加短链

1. 打开数据库仓库的 Issues 页面，点击 **New issue**。
2. 在标题（Title）中填写需要跳转的完整 URL，必须包含 `http://` 或 `https://`。
3. 提交 Issue 后，GitHub 会分配一个 Issue 编号，例如 `123`。
4. 访问 `https://yourdomain.com/123` 即可跳转到对应链接。
5. 所有跳转链接会缓存 60 分钟，可根据需要在 `CACHE_DURATION` 中调整缓存时间（单位：分钟）。

## 5. 验证部署

1. 部署完成后，访问 `https://yourdomain.com/404.html`，在浏览器地址栏追加一个已存在的 Issue 编号，如 `https://yourdomain.com/123`。
2. 页面应显示“正在跳转…”，并在 1 秒后跳转到 Issue 标题中配置的目标地址。
3. 如果提示“请先在 404.html 中配置有效的 GITHUB_API_URL”，说明尚未修改配置或填写不正确。

## 6. 常见问题排查

| 现象 | 解决方案 |
| --- | --- |
| 页面一直停留在“正在解析短链接” | 确认 `GITHUB_API_URL` 是否指向 GitHub Issues API，而不是 GitHub Pages 域名。 |
| 收到 `API 请求频率超限` 提示 | 在 `404.html` 中填入 `GITHUB_TOKEN`，或稍后再试。 |
| 跳转后地址不正确 | 检查 Issue 标题是否是完整 URL，确认没有额外空格。 |
| 自定义域名访问失败 | 检查 DNS 解析是否正确指向 `yourusername.github.io`，并确保 Pages 设置中配置了相同的域名。 |
| 缓存导致跳转过期地址 | 清除浏览器缓存，或缩短 `CACHE_DURATION` 值。 |

## 7. 进阶用法

- **批量创建短链**：可使用 GitHub API 脚本批量创建 Issues，实现批量导入。
- **访问统计**：可在 `index.html` 或 `404.html` 中引入第三方统计脚本，如 Google Analytics。
- **样式定制**：修改 CSS 即可调整页面主题，`index.html` 控制首页展示，`404.html` 控制跳转页样式。

如在使用过程中遇到其他问题，欢迎在仓库的 Issues 中反馈。祝使用愉快！
